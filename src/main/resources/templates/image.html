<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Aiå›¾ç‰‡ç”Ÿæˆ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <style>
      * {
        margin: 0;
        padding: 0;
      }

      body{
          margin:0px;
          background-image: url("/b.png");
          background-size:100% 100%;
          background-attachment:fixed;
      }
      html, body {
        height: 100%;
        background-color: #f5f5f5;
      }


      .input-container {
        border: 1px solid darkgreen;
          padding: 16px;
          display: flex;
          justify-content: space-between;


      }

      .chat-container {
          height: 100vh;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
      }

      #ttsTextarea {
          /*å æ»¡å‰©ä½™ç©ºé—´*/
          flex-grow: 1;
          padding: 8px;
      }

      #submitBtn {
          margin-left: 8px;
          /*å†…é—´è·å¢åŠ ,é¢ç§¯å˜å¤§*/
          padding: 8px 16px;
      }

      /*æ€»çš„divå¸ƒå±€*/
      .message {
          margin-bottom: 15px;
          display: flex;
      }


      /*jsç”Ÿæˆå†…åµŒdivæ ·å¼*/
      .message-content {
          padding: 10px 15px;
          border-radius: 15px;
          max-width: 70%;
      }

      /*æ¥æ”¶jså¤–å›´divçš„èŠå¤©ä¿¡æ¯æ ·å¼(äººå·¥)*/
      .user-message {
          justify-content: flex-end;
      }

      /*æ¥å—jså¤–å›´divçš„èŠå¤©ä¿¡æ¯æ ·å¼(äººæœº)*/
      .ai-message {
          justify-content: flex-start;
      }

      .ai-message img{
          order: 1;
      }

      /*æ¥å—jsçš„èŠå¤©ä¿¡æ¯æ ·å¼(äººå·¥)*/
      .user-message .message-content {
          background: #007bff;
          color: white;
      }

      /*æ¥å—jsçš„èŠå¤©ä¿¡æ¯æ ·å¼(äººæœº)*/
      .ai-message .message-content {
          order: 2;
          background: #e9ecef;
          color: black;
      }


    /*  #btn0{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
      #btn1{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
      #btn2{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
      #btn3{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
      #btn4{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
      #btn5{
          margin-right: 30px;
          background-image: linear-gradient( 135deg, #FAB2FF 10%, #1904E5 100%);
      }
*/
     #i{
          display: flex;
          flex-direction: row;
           width: 50px;
           height: 50px;
      }
     #a{
         display: flex;
         border: salmon 5px dashed;
         flex-direction: row;
         white-space: nowrap;
     }
      #ttsResponse{
          border: 1px solid darkred;
          height: 400px;
          flex-grow: 1;
          padding: 16px;
          /*éšè—è¶…å‡ºçš„yè½´æ•°æ®åŒºåŸŸ*/
          overflow-y: auto;
      }
      .loading{
          color: salmon;
      }

      #ttsForm{
          height: 50px;
          display: flex;
          justify-content: space-between;

      }

      /* éšè—é»˜è®¤çš„å¤é€‰æ¡† */
      input[type="checkbox"] {
          display: none;
      }

      /* æ ‡ç­¾æ ·å¼ï¼Œæ¨¡æ‹Ÿä¸‹æ‹‰æŒ‰é’® */
      label {
          display: block;
          background-color: lightgray;
          padding: 10px;
          cursor: pointer;
      }

      /* æœªé€‰ä¸­æ—¶éšè—è¡¨æƒ…åŒ…åˆ—è¡¨ */
      #emoji-list {
          display: none;
          list-style: none;
          padding: 0;
          margin: 0;
      }

      /* å½“å¤é€‰æ¡†è¢«é€‰ä¸­æ—¶æ˜¾ç¤ºè¡¨æƒ…åŒ…åˆ—è¡¨ */
      input[type="checkbox"]:checked ~ #emoji-list {
          display: block;
      }

      /* è¡¨æƒ…åŒ…åˆ—è¡¨é¡¹æ ·å¼ */
      #emoji-list li {
          display: inline-block;
          padding: 5px;
          background-color: white;
          border: 1px solid lightgray;
          margin: 2px;
      }
      .emoji{
          background: salmon;
      }
      .icon{
          width: 20px;
          height: 20px;
      }


    </style>
</head>
<body>

<div class="chat-container">
    <div class="dropdown" id="a">
        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" style="padding: 5px;">
            æ”¹å˜Aiä¼šè¯æœåŠ¡
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="/chat-demo">AièŠå¤©</a></li>
            <li><a class="dropdown-item" href="/image">Aiå›¾ç‰‡ç”Ÿæˆ</a></li>
            <li><a class="dropdown-item" href="/tts">AiéŸ³é¢‘ç”Ÿæˆ</a></li>
        </ul>
    </div>

    <div id="ttsResponse"></div>

<!--   <div id="n0" class="a0">
       &lt;!&ndash; <div id="n1">

        </div>&ndash;&gt;

    </div>-->

  <div class="input-container">
      <form id="ttsForm">
          <input type="text" id="ttsTextarea" placeholder="è¾“å…¥æ¶ˆæ¯...">
          <div class="upload-icon" onclick="triggerFileSelect()">ğŸ“‚</div>
          <div id="voice-icon">
          <svg t="1733894155460" style="cursor: pointer;" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5585" width="200" height="200"><path d="M512 742.4c-131.413333 0-238.933333-107.52-238.933333-238.933333v-204.8c0-131.413333 107.52-238.933333 238.933333-238.933334s238.933333 107.52 238.933333 238.933334v204.8c0 131.413333-107.52 238.933333-238.933333 238.933333z m0-614.4c-93.866667 0-170.666667 76.8-170.666667 170.666667v204.8c0 93.866667 76.8 170.666667 170.666667 170.666666s170.666667-76.8 170.666667-170.666666v-204.8c0-93.866667-76.8-170.666667-170.666667-170.666667z" fill="#3793DF" p-id="5586"></path><path d="M512 844.8c-187.733333 0-341.333333-153.6-341.333333-341.333333 0-18.773333 15.36-34.133333 34.133333-34.133334s34.133333 15.36 34.133333 34.133334c0 150.186667 122.88 273.066667 273.066667 273.066666s273.066667-122.88 273.066667-273.066666c0-18.773333 15.36-34.133333 34.133333-34.133334s34.133333 15.36 34.133333 34.133334c0 187.733333-153.6 341.333333-341.333333 341.333333z" fill="#3793DF" p-id="5587"></path><path d="M512 930.133333c-18.773333 0-34.133333-15.36-34.133333-34.133333v-68.266667c0-18.773333 15.36-34.133333 34.133333-34.133333s34.133333 15.36 34.133333 34.133333v68.266667c0 18.773333-15.36 34.133333-34.133333 34.133333z" fill="#3793DF" p-id="5588"></path><path d="M853.333333 964.266667H170.666667c-18.773333 0-34.133333-15.36-34.133334-34.133334s15.36-34.133333 34.133334-34.133333h682.666666c18.773333 0 34.133333 15.36 34.133334 34.133333s-15.36 34.133333-34.133334 34.133334z" fill="#3793DF" p-id="5589"></path><path d="M580.266667 264.533333h-136.533334c-18.773333 0-34.133333-15.36-34.133333-34.133333s15.36-34.133333 34.133333-34.133333h136.533334c18.773333 0 34.133333 15.36 34.133333 34.133333s-15.36 34.133333-34.133333 34.133333zM580.266667 435.2h-136.533334c-18.773333 0-34.133333-15.36-34.133333-34.133333s15.36-34.133333 34.133333-34.133334h136.533334c18.773333 0 34.133333 15.36 34.133333 34.133334s-15.36 34.133333-34.133333 34.133333zM580.266667 605.866667h-136.533334c-18.773333 0-34.133333-15.36-34.133333-34.133334s15.36-34.133333 34.133333-34.133333h136.533334c18.773333 0 34.133333 15.36 34.133333 34.133333s-15.36 34.133333-34.133333 34.133334z" fill="#EB4AF4" p-id="5590"></path></svg>
          </div>
          <button type="submit" id="submitBtn">ç”Ÿæˆå›¾ç‰‡</button>
          <div id="ttsResponse1"></div>
      </form>
  </div>

    <label for="emoji-dropdown" class="emoji">ğŸ˜Š--æ·»åŠ è¡¨æƒ…åŒ…</label>
    <input type="checkbox" id="emoji-dropdown">
    <ul id="emoji-list">
        <li onclick="insertEmoji('ğŸ˜€')">ğŸ˜€</li>
        <li onclick="insertEmoji('ğŸ˜')">ğŸ˜</li>
        <li onclick="insertEmoji('ğŸ˜‚')">ğŸ˜‚</li>
        <li onclick="insertEmoji('ğŸ˜ƒ')">ğŸ˜ƒ</li>
        <li onclick="insertEmoji('ğŸ˜„')">ğŸ˜„</li>
        <li onclick="insertEmoji('ğŸ˜…')">ğŸ˜…</li>
        <li onclick="insertEmoji('ğŸ˜†')">ğŸ˜†</li>
        <li onclick="insertEmoji('ğŸ˜‡')">ğŸ˜‡</li>
        <li onclick="insertEmoji('ğŸ˜‰')">ğŸ˜‰</li>
        <li onclick="insertEmoji('ğŸ˜Š')">ğŸ˜Š</li>
        <li onclick="insertEmoji('ğŸ˜‹')">ğŸ˜‹</li>
        <li onclick="insertEmoji('ğŸ˜')">ğŸ˜</li>
        <li onclick="insertEmoji('ğŸ˜')">ğŸ˜</li>
        <li onclick="insertEmoji('ğŸ˜˜')">ğŸ˜˜</li>
        <li onclick="insertEmoji('ğŸ˜œ')">ğŸ˜œ</li>
        <li onclick="insertEmoji('ğŸ˜')">ğŸ˜</li>
        <li onclick="insertEmoji('ğŸ˜›')">ğŸ˜›</li>
        <li onclick="insertEmoji('ğŸ¤‘')">ğŸ¤‘</li>
        <li onclick="insertEmoji('ğŸ˜’')">ğŸ˜’</li>
        <li onclick="insertEmoji('ğŸ˜”')">ğŸ˜”</li>
        <li onclick="insertEmoji('ğŸ˜•')">ğŸ˜•</li>
        <li onclick="insertEmoji('ğŸ˜–')">ğŸ˜–</li>
        <li onclick="insertEmoji('ğŸ˜“')">ğŸ˜“</li>
        <li onclick="insertEmoji('ğŸ˜—')">ğŸ˜—</li>
        <li onclick="insertEmoji('ğŸ˜™')">ğŸ˜™</li>
        <li onclick="insertEmoji('ğŸ˜š')">ğŸ˜š</li>
        <li onclick="insertEmoji('ğŸ˜œ')">ğŸ˜œ</li>
        <li onclick="insertEmoji('ğŸ¤“')">ğŸ¤“</li>
        <li onclick="insertEmoji('ğŸ˜·')">ğŸ˜·</li>
        <li onclick="insertEmoji('ğŸ¤ ')">ğŸ¤ </li>
        <li onclick="insertEmoji('ğŸ¤¡')">ğŸ¤¡</li>
        <li onclick="insertEmoji('ğŸ’€')">ğŸ’€</li>
        <li onclick="insertEmoji('ğŸ‘»')">ğŸ‘»</li>
        <li onclick="insertEmoji('ğŸ‘½')">ğŸ‘½</li>
        <li onclick="insertEmoji('ğŸ¤–')">ğŸ¤–</li>
        <li onclick="insertEmoji('ğŸ’©')">ğŸ’©</li>
        <li onclick="insertEmoji('ğŸƒ')">ğŸƒ</li>
        <li onclick="insertEmoji('ğŸ¶')">ğŸ¶</li>
        <li onclick="insertEmoji('ğŸ±')">ğŸ±</li>
        <li onclick="insertEmoji('ğŸ­')">ğŸ­</li>
        <li onclick="insertEmoji('ğŸ¹')">ğŸ¹</li>
        <li onclick="insertEmoji('ğŸ°')">ğŸ°</li>
        <li onclick="insertEmoji('ğŸ»')">ğŸ»</li>
        <li onclick="insertEmoji('ğŸ¼')">ğŸ¼</li>
        <li onclick="insertEmoji('ğŸ¯')">ğŸ¯</li>
        <li onclick="insertEmoji('ğŸ¨')">ğŸ¨</li>
        <li onclick="insertEmoji('ğŸ¸')">ğŸ¸</li>
        <li onclick="insertEmoji('ğŸµ')">ğŸµ</li>
        <li onclick="insertEmoji('ğŸ™ˆ')">ğŸ™ˆ</li>
        <li onclick="insertEmoji('ğŸ™‰')">ğŸ™‰</li>
        <li onclick="insertEmoji('ğŸ™Š')">ğŸ™Š</li>
        <li onclick="insertEmoji('ğŸ¦„')">ğŸ¦„</li>
        <li onclick="insertEmoji('ğŸ—')">ğŸ—</li>
        <li onclick="insertEmoji('ğŸ´')">ğŸ´</li>
        <li onclick="insertEmoji('ğŸ”')">ğŸ”</li>
        <li onclick="insertEmoji('ğŸ§')">ğŸ§</li>
        <li onclick="insertEmoji('ğŸ¦')">ğŸ¦</li>
        <li onclick="insertEmoji('ğŸ¤')">ğŸ¤</li>
        <li onclick="insertEmoji('ğŸ£')">ğŸ£</li>
        <li onclick="insertEmoji('ğŸ¥')">ğŸ¥</li>
        <li onclick="insertEmoji('ğŸ¦†')">ğŸ¦†</li>
        <li onclick="insertEmoji('ğŸ¦…')">ğŸ¦…</li>
        <li onclick="insertEmoji('ğŸ¦‰')">ğŸ¦‰</li>
        <li onclick="insertEmoji('ğŸ¦‡')">ğŸ¦‡</li>
        <li onclick="insertEmoji('ğŸº')">ğŸº</li>
        <li onclick="insertEmoji('ğŸ¦Š')">ğŸ¦Š</li>
        <li onclick="insertEmoji('ğŸ¦')">ğŸ¦</li>
        <li onclick="insertEmoji('ğŸ—')">ğŸ—</li>
        <li onclick="insertEmoji('ğŸº')">ğŸº</li>
        <li onclick="insertEmoji('ğŸ‰')">ğŸ‰</li>
        <li onclick="insertEmoji('ğŸ¦‹')">ğŸ¦‹</li>
        <li onclick="insertEmoji('ğŸ')">ğŸ</li>
        <li onclick="insertEmoji('ğŸœ')">ğŸœ</li>
        <li onclick="insertEmoji('ğŸ¢')">ğŸ¢</li>
        <li onclick="insertEmoji('ğŸ')">ğŸ</li>
        <li onclick="insertEmoji('ğŸ¦')">ğŸ¦</li>
        <li onclick="insertEmoji('ğŸ™')">ğŸ™</li>
        <li onclick="insertEmoji('ğŸ¦‘')">ğŸ¦‘</li>
        <li onclick="insertEmoji('ğŸš')">ğŸš</li>
        <li onclick="insertEmoji('ğŸ‹')">ğŸ‹</li>
        <li onclick="insertEmoji('ğŸ¬')">ğŸ¬</li>
        <li onclick="insertEmoji('ğŸ¦ˆ')">ğŸ¦ˆ</li>
        <li onclick="insertEmoji('ğŸŸ')">ğŸŸ</li>
        <li onclick="insertEmoji('ğŸ ')">ğŸ </li>
        <li onclick="insertEmoji('ğŸ¡')">ğŸ¡</li>
        <li onclick="insertEmoji('ğŸ¦')">ğŸ¦</li>
        <li onclick="insertEmoji('ğŸ¦‘')">ğŸ¦‘</li>
        <li onclick="insertEmoji('ğŸŒ')">ğŸŒ</li>
        <li onclick="insertEmoji('ğŸ¦‹')">ğŸ¦‹</li>
        <li onclick="insertEmoji('ğŸ›')">ğŸ›</li>
        <li onclick="insertEmoji('ğŸ¦—')">ğŸ¦—</li>
        <li onclick="insertEmoji('ğŸ¦ ')">ğŸ¦ </li>
        <li onclick="insertEmoji('ğŸ¦€')">ğŸ¦€</li>
        <li onclick="insertEmoji('ğŸ¦')">ğŸ¦</li>
        <li onclick="insertEmoji('ğŸ¦ª')">ğŸ¦ª</li>
        <!-- æ·»åŠ æ›´å¤šè¡¨æƒ…åŒ… -->
    </ul>


</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/mammoth@1.4.8/mammoth.browser.min.js"></script>
<script src="./jquery.min.js"></script>

<script>
    const chatHistory = document.getElementById('ttsResponse');
    const submitBtn = document.getElementById('submitBtn');
    const messageInput = document.getElementById('ttsTextarea');
    // const element = document.getElementById('n0');
    // const element1 = document.getElementById('n1');

    document.getElementById("voice-icon").addEventListener("click", startSpeechRecognition);

    function startSpeechRecognition() {
        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

        recognition.lang = "zh-CN";  // è®¾ç½®è¯­è¨€ä¸ºä¸­æ–‡
        recognition.interimResults = true;  // æ”¯æŒå®æ—¶è¯†åˆ«
        recognition.maxAlternatives = 1;  // è®¾ç½®æœ€å¤§è¯†åˆ«å€™é€‰

        recognition.start();  // å¼€å§‹è¯­éŸ³è¯†åˆ«

        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript;  // è·å–è¯­éŸ³è¯†åˆ«ç»“æœ
            messageInput.value = transcript;  // å°†è¯†åˆ«ç»“æœå¡«å…¥è¾“å…¥æ¡†
        };

        recognition.onerror = function(event) {
            console.error("è¯­éŸ³è¯†åˆ«é”™è¯¯: ", event.error);  // æ•è·é”™è¯¯
        };

        recognition.onspeechend = function() {
            console.log("è¯­éŸ³è¯†åˆ«ç»“æŸ");  // è¯­éŸ³è¾“å…¥ç»“æŸ
        };

        if (!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) {
            alert("æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½ã€‚");
        }

    }


    // åˆ›å»ºä¸€ä¸ªéšè—çš„æ–‡ä»¶é€‰æ‹©æ¡†
    function triggerFileSelect() {
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = '.txt, .jpg, .png , .docx'; // æ–‡ä»¶ç±»å‹é™åˆ¶

        // å½“æ–‡ä»¶é€‰æ‹©å‘ç”Ÿæ—¶ï¼Œè§¦å‘æ–‡ä»¶ä¸Šä¼ 
        fileInput.addEventListener('change', uploadFile);
        fileInput.click(); // ç¨‹åºæ€§ç‚¹å‡»ï¼Œè§¦å‘æ–‡ä»¶é€‰æ‹©æ¡†
    }

    // å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘
    function uploadFile(event) {
        const file = event.target.files[0];

        if (file) {
            const fileType = file.type;

            // å¤„ç†å›¾ç‰‡æ–‡ä»¶
            if (fileType.startsWith("image/")) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const image = new Image();
                    image.src = e.target.result;
                    image.style.maxWidth = '100%'; // é™åˆ¶å›¾ç‰‡å®½åº¦
                    messageInput.value = ''; // æ¸…ç©ºæ–‡æœ¬æ¡†å†…å®¹
                    const imageContainer = document.querySelector('.image-container');
                    imageContainer.innerHTML = ''; // æ¸…é™¤ä¹‹å‰çš„å›¾ç‰‡
                    imageContainer.appendChild(image);
                };
                reader.readAsDataURL(file);
            }
            // å¤„ç†TXTæ–‡ä»¶
            else if (fileType === "text/plain") {
                const reader = new FileReader();
                reader.onload = function(e) {
                    messageInput.value = e.target.result;
                    document.querySelector('.image-container').innerHTML = ''; // æ¸…é™¤å›¾ç‰‡æ˜¾ç¤º
                };
                reader.readAsText(file);
            }
            // å¤„ç†DOCXæ–‡ä»¶
            else if (fileType === "application/vnd.openxmlformats-officedocument.wordprocessingml.document") {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const arrayBuffer = e.target.result;
                    mammoth.convertToHtml({ arrayBuffer: arrayBuffer })
                        .then(function(result) {
                            messageInput.value = result.value;
                            document.querySelector('.image-container').innerHTML = ''; // æ¸…é™¤å›¾ç‰‡æ˜¾ç¤º
                        })

                };
                reader.readAsArrayBuffer(file);
            } else {
                alert("è¯·é€‰æ‹©æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ï¼");
            }
        }
    }



    //Aiè¡¨æƒ…åŒ…æ·»åŠ åˆ°è¾“å…¥æ¡†
    function insertEmoji(emoji) {
        messageInput.value += emoji;  // Insert emoji at the end of the input field

    }

    $("#ttsForm").submit(function(event) {
        event.preventDefault();

        if ($("#ttsTextarea").val().length < 3) {
            alert("æ–‡æœ¬å¤ªçŸ­äº†")
        } else {
            // è®¾ç½®æäº¤æŒ‰é’®æ— æ³•ç‚¹å‡»
            $("#submitBtn").prop('disabled', true);
            // ç‚¹å‡»æäº¤æŒ‰é’®åè®©é¡µé¢æš‚æ—¶è¿”å›éŸ³é¢‘ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...çš„æ–‡å­—
            $("#ttsResponse1").html('<div class="loading">å›¾ç‰‡ç”Ÿæˆä¸­ï¼Œè¯·ç¨å€™...</div>');
            // addMessage1($("#ttsTextarea").val());
            addMessage($("#ttsTextarea").val());
            // $("#btn0").prop('disabled', true);
            $.get("/ai/image/" + $("#ttsTextarea").val(), {}, function(resp) {
                addMessage(resp);
            }).always(function() {
                // è®¾ç½®æäº¤æŒ‰é’®æ— æ³•ç‚¹å‡»
                $("#submitBtn").prop('disabled', false);
            });
            messageInput.value = '';
        }

    });

    function getResponseFromServer(message){
        //å¼•ç”¨jquery.jsæ–‡ä»¶
        $.get("/ai/chat", {message: message}, function(resp) {
            addMessage(resp, true)

        });

    }

    let flag=0;
    function addMessage(content, isAI = false) {

        //æ–°å»ºå¤–å›´æ€»divåŒºåŸŸ
        const messageDiv = document.createElement('div');
        //è®¾ç½®å¤–å›´æ€»çš„divçš„nameå±æ€§(åŒºåˆ†æ˜¯å¦æ˜¯ai)
        if(flag!=0){
            isAI=true;
        }
        messageDiv.className = `message ${isAI ? 'ai-message' : 'user-message'}`;
        //æ–°å»ºå†…å›´åµŒå¥—divåŒºåŸŸ
        const messageContent = document.createElement('div');
        //è®¾ç½®å†…å›´åµŒå¥—divçš„nameå±æ€§
        messageContent.className = 'message-content';
        //å°†è·å–çš„è¾“å…¥æ¡†ä¿¡æ¯åŠ å…¥åˆ°åµŒå¥—divåŒºåŸŸ
        messageContent.textContent = content;
        var img=document.createElement("img");
        img.id="i";
        if(isAI==true){
            img.src="/æ™ºèƒ½æœºå™¨äºº.png";
        }else{
            img.src="/2.png";
        }

        const messageImg = document.createElement('img');
        messageImg.id="i1";
        messageImg.src=content;
        flag+=1;

        if(flag==2){
            // $("#btn0").prop('disabled', false);
            $("#ttsResponse1").html('<div class="loading"></div>');
            chatHistory.appendChild(messageDiv);
            messageDiv.appendChild(img);
            messageDiv.appendChild(messageImg);
            flag=0;
        }else{
            messageDiv.appendChild(messageContent);
            chatHistory.appendChild(messageDiv);
            messageDiv.appendChild(img);

            // æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }



    }







    /*var flag1=0;
    function addMessage1(content, isAI = false) {
        const messageContent1 = document.createElement('div');
        messageContent1.className = 'a';
        if(flag1==6){
            return;
        }
        const oBtn = document.createElement("input");
        oBtn.id = "btn"+flag1;
        oBtn.type = "button";
        oBtn.value = content;

        flag1++;
        element.appendChild(messageContent1);
        element1.appendChild(oBtn);

        // æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
        element1.scrollTop = element1.scrollWidth;
    }*/



   /* //äº‹ä»¶ç»‘å®š(å®ç°ç”Ÿæˆçš„æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶)
    $("#n1").on('click', '#btn0', function (){
        const message = document.getElementById('btn0').value;
        if (message) {
            $.get("/ai/image/" + message, {}, function(resp) {
                addMessage(resp);
            }).always(function() {
                // è®¾ç½®æäº¤æŒ‰é’®æ— æ³•ç‚¹å‡»
                $("#btn0").prop('disabled', false);
            });

        }


    })

    //äº‹ä»¶ç»‘å®š(å®ç°ç”Ÿæˆçš„æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶)
    $("#n1").on('click', '#btn1', function (){
        const message = document.getElementById('btn1').value;
        if (message) {
            addMessage(message);

        }


    })

    //äº‹ä»¶ç»‘å®š(å®ç°ç”Ÿæˆçš„æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶)
    $("#n1").on('click', '#btn2', function (){
        const message = document.getElementById('btn2').value;
        if (message) {
            addMessage(message);

        }


    })


    //äº‹ä»¶ç»‘å®š(å®ç°ç”Ÿæˆçš„æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶)
    $("#n1").on('click', '#btn3', function (){
        const message = document.getElementById('btn3').value;
        if (message) {
            addMessage(message);

        }


    })

    //äº‹ä»¶ç»‘å®š(å®ç°ç”Ÿæˆçš„æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶)
    $("#n1").on('click', '#btn4', function (){
        const message = document.getElementById('btn4').value;
        if (message) {
            addMessage(message);

        }


    })
*/

</script>
</body>
</html>
